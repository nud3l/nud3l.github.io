<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Stealing All of Maker&#x27;s Collateral | Navigating Blocks and Chains</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://harz.dev/img/header.jpg"><meta data-rh="true" name="twitter:image" content="https://harz.dev/img/header.jpg"><meta data-rh="true" property="og:url" content="https://harz.dev/blog/maker-collateral-attack"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Stealing All of Maker&#x27;s Collateral | Navigating Blocks and Chains"><meta data-rh="true" name="description" content="Or why Oracle Vulnerabilities are not the Worst Application of Flash Loans."><meta data-rh="true" property="og:description" content="Or why Oracle Vulnerabilities are not the Worst Application of Flash Loans."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-02-20T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://harz.dev"><meta data-rh="true" property="article:tag" content="DeFi,MakerDAO,Security,Flashloans"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://harz.dev/blog/maker-collateral-attack"><link data-rh="true" rel="alternate" href="https://harz.dev/blog/maker-collateral-attack" hreflang="en"><link data-rh="true" rel="alternate" href="https://harz.dev/blog/maker-collateral-attack" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Navigating Blocks and Chains RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Navigating Blocks and Chains Atom Feed">



<link rel="preconnect" href="https://harz_dev.goatcounter.com">
<script async src="//gc.zgo.at/count.js" data-goatcounter="https://harz_dev.goatcounter.com/count"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9fffcc12.css">
<link rel="preload" href="/assets/js/runtime~main.fc0da3ec.js" as="script">
<link rel="preload" href="/assets/js/main.ed89b28f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/contact">Contact</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/rust-verification">Verifying Rust: Exploring Verification Options for Substrate</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/lean-execution">Lean Execution: How to Stay Focused</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/maker-collateral-attack">Stealing All of Maker&#x27;s Collateral</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/analysing-ethereum-gas-cost">Analysing Ethereum contract gas costs during development</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bitcoin-smart-contracts-mechanism-design">Analyzing Bitcoin smart contracts from a mechanism design perspective</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ethereum-python-integration">Integrating Python and Ethereum</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/quantitative-finance-zipline">Quantitative finance with zipline</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/breaking-captchas">Breaking captchas: Using deep learning to automatically break CAPTCHAs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/dinvest-hedge-fund-on-a-blockchain">dInvest - hedge fund on a blockchain</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Stealing All of Maker&#x27;s Collateral</h1><div class="container_mt6G margin-vert--md"><time datetime="2020-02-20T00:00:00.000Z" itemprop="datePublished">February 20, 2020</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://harz.dev" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/nud3l.png" alt="Dominik Harz"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://harz.dev" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Dominik Harz</span></a></div><small class="avatar__subtitle" itemprop="description">CTO Interlay</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>Or why Oracle Vulnerabilities are not the Worst Application of Flash Loans.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tldr">tl;dr<a href="#tldr" class="hash-link" aria-label="Direct link to tl;dr" title="Direct link to tl;dr">​</a></h2><ul><li>You can potentially steal all of Maker’s collateral ($700m) and issue arbitrary amounts of new Dai using flash loans if no delay for new governance contracts is introduced.</li><li>Anyone can execute the attack and only needs to pay the transaction fees (few $) without holding any MKR.</li><li>If Maker does not introduce a delay until the liquidity pools for flash loan pools gets above a threshold, there is little chance to prevent the attack (race condition).</li><li>We have reached out to Maker February 8, 2020 about our research and had a call with them on February 14, 2020 to discuss our findings. Maker is aware of the attack vector <a href="https://forum.makerdao.com/t/all-mkr-holders-on-friday-12pm-pst-please-vote-for-the-gsm-to-be-activated/1303" target="_blank" rel="noopener noreferrer">and is holding a vote this Friday 12pm PST that would prevent the attack</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>Maker and its Dai stablecoin is the most popular so-called decentralized finance (DeFi) project on Ethereum with around of $700m locked in its smart contracts. The Maker protocol relies on a governance process encoded in a smart contract. MKR token holders can vote to replace an existing governance contract. Votes are proportional to the amount of MKR. The total number of MKR tokens is around 987,530 <a href="https://etherscan.io/token/0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2#balances" target="_blank" rel="noopener noreferrer">where selected wallets or contracts hold large quantities of the token</a>:</p><ul><li>[Maker Governance Contract: 192,910 MKR]</li><li>Maker Foundation: 117,993 MKR</li><li>a16z: 60,000 MKR</li><li>0xfc7e22c6afa3ebb723bdde26d6ab3783aab9726b: 51,291 MKR</li><li>0x000be27f560fef0253cac4da8411611184356549: 39,645 MKR</li></ul><p>Note: the Maker Governance Contract contains MKR tokens of multiple parties.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="governance-attack">Governance Attack<a href="#governance-attack" class="hash-link" aria-label="Direct link to Governance Attack" title="Direct link to Governance Attack">​</a></h2><p>In a <a href="https://medium.com/coinmonks/how-to-turn-20m-into-340m-in-15-seconds-48d161a42311" target="_blank" rel="noopener noreferrer">post from December 2019, Micah Zoltu</a> pointed out how to attack the Maker governance contract. The basic idea is to accumulate enough MKR tokens to replace the existing governance contract with the attackers, malicious, governance contract. The malicious governance contract is then able to give the attacker full control over the system and withdraw any collateral in the system as well as create arbitrary amounts of new Dai.</p><p>To reduce the number of required MKR tokens, he proposed to execute the attack when new governance contracts are being voted on. At the moment, 192,910 MKR tokens are locked in the governance contract. However, an attacker would need less tokens if, say two or three contracts, would be voted on in parallel with similar token distributions. This frequently happened in the past as we can observe in the graph below:</p><p><img loading="lazy" src="/assets/images/mkr_locked-79e0b1ef4dcbf0f4e43816d4364c5e75.webp" width="640" height="480" class="img_ev3q"></p><p>The obvious attack strategy would be to crowd-fund the required MKR tokens through a smart contract and pay each attacker a share of the of the winnings. However, the attackers need to amass probably around 50k MKR tokens to have a chance to attack the system without Maker noticing these movements. We do show a strategy for this in our <a href="https://arxiv.org/abs/2002.08099" target="_blank" rel="noopener noreferrer">latest paper</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-brave-new-attack-strategy-flash-loans">A Brave New Attack Strategy: Flash Loans<a href="#a-brave-new-attack-strategy-flash-loans" class="hash-link" aria-label="Direct link to A Brave New Attack Strategy: Flash Loans" title="Direct link to A Brave New Attack Strategy: Flash Loans">​</a></h2><p>However, we can completely lift the requirement to amass MKR tokens if we consider using flash loans instead. Flash loans are a fairly new concept and therefore we give a brief explanation here. Normally, an agent has to provide collateral to take out a loan in the DeFi space. For example, in Maker, Alice can borrow Dai by depositing ETH. This is required since we operate under a model of <a href="https://bdlt.school/files/slides/talk-rainer-b%C3%B6hme-a-primer-on-economics-for-cryptocurrencies.pdf" target="_blank" rel="noopener noreferrer">weak identities</a> and <a href="https://eprint.iacr.org/2019/675" target="_blank" rel="noopener noreferrer">economically rational agents</a>.</p><p>A flash loan lifts this requirement as it only takes place in a single transaction:</p><ol><li>Alice takes out the loan from a flash loan liquidity provider (e.g. Aave or dYdX)</li><li>Alice executes some actions (e.g. arbitrage trading on Uniswap, Fulcrum, Kyber etc.)</li><li>Alice pays back the flash loan with interest</li></ol><p>A flash loan works in three steps within a single transaction.</p><p><img loading="lazy" src="/assets/images/flash-loan-ad22ea3dffc0db7e13540ee02ccca7ac.webp" width="966" height="389" class="img_ev3q"></p><p>The flash loan works because of how the Ethereum Virtual Machine is designed: if at any point during this transaction the flash loan fails, the whole transaction is reverted. Hence, Alice can take the loan risk free, i.e. if she cannot pay it back it would be like she would have never taken it. The liquidity providers are also winning: they have only lent their funds if Alice was able to pay them back.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="arbitrage-and-oracle-manipulation-with-flash-loans">Arbitrage and Oracle Manipulation with Flash Loans<a href="#arbitrage-and-oracle-manipulation-with-flash-loans" class="hash-link" aria-label="Direct link to Arbitrage and Oracle Manipulation with Flash Loans" title="Direct link to Arbitrage and Oracle Manipulation with Flash Loans">​</a></h2><p>On February 14 and February 18, two incidents involving flash loans occurred that caused <a href="https://bzx.network/" target="_blank" rel="noopener noreferrer">bZx</a> to halt its platform. In the <a href="https://etherscan.io/tx/0xb5c8bd9430b6cc87a0e2fe110ece6bf527fa4f170a4bc8cd032f768fc5219838" target="_blank" rel="noopener noreferrer">first transaction</a>, a single flash loan was able to make a profit of 1,193 ETH (approx. $298,250). This transaction was executed using a smart contract that opened a short position on Fulcrum on wBTC. In the same transaction, the transaction took out a wBTC loan on Compound and executed a trade of wBTC on Kyber’s Uniswap reserve resulting in slippage ultimately bringing down the price on Fulcrum as well. The full details can be found in the <a href="https://bzx.network/blog/postmortem-ethdenver" target="_blank" rel="noopener noreferrer">post-mortem by bZx</a> and a <a href="https://medium.com/@peckshield/bzx-hack-full-disclosure-with-detailed-profit-analysis-e6b1fa9b18fc" target="_blank" rel="noopener noreferrer">detailed analysis of the involved calls by PeckShield</a>.</p><p>Similarly, a second incident occurred on February 18 where in a <a href="https://etherscan.io/tx/0x762881b07feb63c436dee38edd4ff1f7a74c33091e534af56c9f7d49b5ecac15" target="_blank" rel="noopener noreferrer">single transaction</a> a profit of 2,378 ETH (approx. $600,000) was made. This transaction involved an initial borrowing of 7,500 ETH to take a long position on <a href="https://www.synthetix.io/tokens/" target="_blank" rel="noopener noreferrer">Synthetix&#x27;</a> sUSD. More details are found in this <a href="https://twitter.com/DegenSpartan/status/1229646531717820416?s=20" target="_blank" rel="noopener noreferrer">informal analysis</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="oracle-manipulation-to-reduce-required-liquidity">Oracle Manipulation to Reduce Required Liquidity<a href="#oracle-manipulation-to-reduce-required-liquidity" class="hash-link" aria-label="Direct link to Oracle Manipulation to Reduce Required Liquidity" title="Direct link to Oracle Manipulation to Reduce Required Liquidity">​</a></h2><p>For our attack, we assume that 50k MKR are sufficient. Even if in practice the number of tokens could be higher, we point out how the concept of flash loans makes securing Maker, without a governance delay, hard. In a naive approach, the attacker could take out a flash loan to buy 50k MKR tokens.</p><p>At current exchange rates, the attacker <a href="https://dexindex.io/?symbol=MKR&amp;amount=50000&amp;action=buy" target="_blank" rel="noopener noreferrer">needs around 485,000 ETH to buy that amount of MKR as only a single exchange</a>, Kyber, has enough volume available. However, the attacker can also leverage multiple exchanges and buy 38k MKR from Kyber, 11.5k from Uniswap, and 500 MKR from Switcheo for a total of 378,940 ETH. That number is still high but already a reduction by almost 100,000 ETH!</p><p>An attacker can use the oracle manipulation strategies above to effectively bring down the price of MKR on Kyber and Uniswap. These are the two largest providers of MKR and have shown to be vulnerable to oracle price manipulation. Further analysis is required to determine how much the MKR price can be reduced. However, on a less liquid token like wBTC an <a href="https://medium.com/@peckshield/bzx-hack-full-disclosure-with-detailed-profit-analysis-e6b1fa9b18fc" target="_blank" rel="noopener noreferrer">attacker was able manipulate the exchange rate by around 285%</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="obtaining-enough-liquidity">Obtaining enough Liquidity<a href="#obtaining-enough-liquidity" class="hash-link" aria-label="Direct link to Obtaining enough Liquidity" title="Direct link to Obtaining enough Liquidity">​</a></h2><p><img loading="lazy" alt="eth-locked.webp" src="/assets/images/eth-locked-49ebf20958f73b922d3811a3aceafa28.webp" width="786" height="412" class="img_ev3q"></p><p>Even with oracle manipulation, a large number of ETH is required to execute the attack on Maker. However, an attacker can increase its liquidity by taking out two flash loans within the same transaction. Aave and dYdX protect themselves against reentrancy and allow only a single flash loan within a single transaction. But the attacker can borrow ETH from both protocols within the same transaction.</p><p><img loading="lazy" src="/assets/images/eth-locked-dydx-71e47f9a802fa4f73b434ccd6f490d88.webp" width="783" height="413" class="img_ev3q"></p><p>Thus, as of February 18, the attacker has a pool of around <a href="https://trade.dydx.exchange/markets" target="_blank" rel="noopener noreferrer">90k ETH on dYdX</a> plus <a href="https://app.aave.com/borrow/ETH" target="_blank" rel="noopener noreferrer">17k ETH on Aave</a> available. Hence, at current liquidity rates an attacker could take out a combined ~107k ETH loan from both dYdX and Aave to try to manipulate the MKR token price and obtain enough MKR tokens to replace the current Maker governance contract with its own.</p><p>For this to succeed the attacker must be able to reduce average MKR price by at least 3.54 times. Alternatively, the attacker can also wait for dYdX and Aave to increase its liquidity pools. With the current growth rate of around 5% of both protocols, it does not seem unlikely that the attack becomes possible within two months.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="combination">Combination?<a href="#combination" class="hash-link" aria-label="Direct link to Combination?" title="Direct link to Combination?">​</a></h2><p>Obviously, it is possible to combine the crowd funding approach and the flash loan together. Using the available liquidity of ~107k ETH, it is possible to obtain around 10,800 MKR from Kyber. This would allow multiple attackers to reduce the required amount of pooling together 50k MKR to just around 39.2k MKR. It seems also that some people are indeed interested in such an attack as this informal Twitter poll shows:</p><p><img loading="lazy" src="/assets/images/twitter-ca74db5863009f30e89defb4e12a4a17.webp" width="786" height="376" class="img_ev3q"></p><p><a href="https://etherscan.io/token/0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2#balances" target="_blank" rel="noopener noreferrer">It can also be noted that the top four account holders</a> (in fact five, but not considering the current Maker Governance Contract) are able to execute the attack without crowdfunding.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="no-time-to-wait">No Time to Wait<a href="#no-time-to-wait" class="hash-link" aria-label="Direct link to No Time to Wait" title="Direct link to No Time to Wait">​</a></h2><p>Once enough liquidity is available through the flash loan lending pools (with or without the combination of using oracle manipulation), anyone is able to take over the Maker governance contract. Once Maker starts a vote when the liquidity pools have reached that threshold, Maker needs to ensure that MKR tokens are as little distributed as possible. If the distribution of MKR at any point in this voting procedure allows for an exploit of the vulnerability, any collateral can be taken away.</p><p>That attacker would be able to steal $700m worth of ETH collateral and be able to print new Dai at will. This attack would spread throughout the whole DeFi space as Dai is used as backing collateral in other protocols. Further, the attacker can use his Dai to trade other currencies worth around $230m. <a href="https://arxiv.org/abs/2002.08099" target="_blank" rel="noopener noreferrer">We give a more detailed analysis in our paper.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="counter-measure">Counter measure<a href="#counter-measure" class="hash-link" aria-label="Direct link to Counter measure" title="Direct link to Counter measure">​</a></h2><p>Maker should put a new governance contract in place that prevents flash loans from attacking their system. Specifically, a new governance contract should be able to be checked by the Maker Foundation for malicious code and give enough time to react. At the bare minimum, a new governance contract should not be able to go live within a single transaction. That way, the attacker can likely not profit from the attack and thus not repay the flash loan.
If the attacker cannot repay the flash loan, the attack is like it would have never happened.</p><p>Maker is putting such a contract to vote on Friday, 12pm PST, February 21, 2020. <a href="https://forum.makerdao.com/t/all-mkr-holders-on-friday-12pm-pst-please-vote-for-the-gsm-to-be-activated/1303/2" target="_blank" rel="noopener noreferrer">The proposed contract would activate the Governance Security Module (GSM) and prevent such a flash loan attack.</a></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/de-fi">DeFi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/maker-dao">MakerDAO</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/security">Security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/flashloans">Flashloans</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/nud3l/nud3l.github.io/blog/2020-02-20-maker/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/lean-execution"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Lean Execution: How to Stay Focused</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/analysing-ethereum-gas-cost"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Analysing Ethereum contract gas costs during development</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tldr" class="table-of-contents__link toc-highlight">tl;dr</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#governance-attack" class="table-of-contents__link toc-highlight">Governance Attack</a></li><li><a href="#a-brave-new-attack-strategy-flash-loans" class="table-of-contents__link toc-highlight">A Brave New Attack Strategy: Flash Loans</a></li><li><a href="#arbitrage-and-oracle-manipulation-with-flash-loans" class="table-of-contents__link toc-highlight">Arbitrage and Oracle Manipulation with Flash Loans</a></li><li><a href="#oracle-manipulation-to-reduce-required-liquidity" class="table-of-contents__link toc-highlight">Oracle Manipulation to Reduce Required Liquidity</a></li><li><a href="#obtaining-enough-liquidity" class="table-of-contents__link toc-highlight">Obtaining enough Liquidity</a></li><li><a href="#combination" class="table-of-contents__link toc-highlight">Combination?</a></li><li><a href="#no-time-to-wait" class="table-of-contents__link toc-highlight">No Time to Wait</a></li><li><a href="#counter-measure" class="table-of-contents__link toc-highlight">Counter measure</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Dominik Harz. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fc0da3ec.js"></script>
<script src="/assets/js/main.ed89b28f.js"></script>
</body>
</html>